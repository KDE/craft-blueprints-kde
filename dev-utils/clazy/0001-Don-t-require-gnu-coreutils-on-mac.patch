From 5a6e2eab2070a70a93ad4a0663680158113ec270 Mon Sep 17 00:00:00 2001
From: Hannah von Reth <vonreth@kde.org>
Date: Mon, 8 Sep 2025 16:51:34 +0200
Subject: [PATCH] Don't require gnu coreutils on mac

Current versions of mac ship a compatible readlink util
---
 CMakeLists.txt | 13 +++++++------
 1 file changed, 7 insertions(+), 6 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 6867c38e..6f73a39f 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -188,13 +188,14 @@ if (NOT CLAZY_BUILD_WITH_CLANG)
   )
 
   if(NOT WIN32)
+     find_program(READLINK_CMD readlink)
+
     if(APPLE)
-      find_program(READLINK_CMD greadlink)
-    else()
-      find_program(READLINK_CMD readlink)
-    endif()
-    if(NOT READLINK_CMD)
-      message(FATAL_ERROR "Could not find a proper readlink.  On Mac OSX you should install coreutils using homebrew in order to use the GNU readlink")
+      # for historic reasons we prefer greadlink
+      find_program(GREADLINK_CMD greadlink)
+      if (GREADLINK_CMD)
+        set(READLINK_CMD ${READLINK_CMD})
+      endif()
     endif()
     file(RELATIVE_PATH BIN_RELATIVE_LIBDIR "${CMAKE_INSTALL_FULL_BINDIR}" "${CMAKE_INSTALL_FULL_LIBDIR}")
     file(RELATIVE_PATH BIN_RELATIVE_SHAREDIR "${CMAKE_INSTALL_FULL_BINDIR}" "${CMAKE_INSTALL_FULL_DATAROOTDIR}")
-- 
2.39.5 (Apple Git-154)

