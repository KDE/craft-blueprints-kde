From 2953e4c2551dda307d2cbe11fd2ed9291fa6388a Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Ingo=20Kl=C3=B6cker?= <kloecker@kde.org>
Date: Thu, 15 Jan 2026 11:50:07 +0100
Subject: [PATCH] Avoid ambiguous constructor call to fix Windows build with
 gpgmepp 2
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

In the first case we can remove the superfluous third argument (which
defaults to true). In the second case we explicitly cast the size
argument to the expected type to avoid the ambiguity.


(cherry picked from commit 7e3237597ab8b7b91542f12026d98f7c2c5012c4)

Co-authored-by: Ingo Kl√∂cker <dev@ingo-kloecker.de>
---
 addons/kategpgplugin/gpgmeppwrapper.cpp | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/addons/kategpgplugin/gpgmeppwrapper.cpp b/addons/kategpgplugin/gpgmeppwrapper.cpp
index 43435c2faa..16356f41ac 100644
--- a/addons/kategpgplugin/gpgmeppwrapper.cpp
+++ b/addons/kategpgplugin/gpgmeppwrapper.cpp
@@ -144,7 +144,7 @@ const GPGOperationResult GPGMeWrapper::decryptString(const QString &inputString_
     // we have to transform the encrypted text to a const char* buffer
     // QString->toUtf8->constData()
     QByteArray bar = inputString_.toUtf8();
-    GpgME::Data encryptedString(bar.constData(), length, true);
+    GpgME::Data encryptedString(bar.constData(), length);
     GpgME::Data decryptedString;
     // attempt to decrypt
     GpgME::DecryptionResult d_res = ctx->decrypt(encryptedString, decryptedString);
@@ -248,10 +248,10 @@ const GPGOperationResult GPGMeWrapper::encryptString(const QString &inputString_
 bool GPGMeWrapper::isEncrypted(const QString &inputString_)
 {
     QByteArray bar = inputString_.toUtf8();
-    GpgME::Data dataIn(bar.constData(), bar.size(),
+    GpgME::Data dataIn(bar.constData(), (size_t)bar.size(),
                        false); // false = do not copy
     QByteArray outBuffer;
-    GpgME::Data dataOut(outBuffer.constData(), outBuffer.size(), true);
+    GpgME::Data dataOut(outBuffer.constData(), outBuffer.size());
     std::unique_ptr<GpgME::Context> ctx(GpgME::Context::createForProtocol(GpgME::OpenPGP));
     if (!ctx)
         return false;
--
2.52.0
